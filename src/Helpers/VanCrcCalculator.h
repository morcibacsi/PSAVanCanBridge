#pragma once

#ifndef _VanCrcCalculator_h
#define _VanCrcCalculator_h

#include <stdint.h>

class VanCrcCalculator
{
    const uint16_t VAN_CRC15_TABLE[256] =
    {
      0x0000, 0x0F9D, 0x1F3A, 0x10A7, 0x3E74, 0x31E9, 0x214E, 0x2ED3,
      0x7CE8, 0x7375, 0x63D2, 0x6C4F, 0x429C, 0x4D01, 0x5DA6, 0x523B,
      0xF64D, 0xF9D0, 0xE977, 0xE6EA, 0xC839, 0xC7A4, 0xD703, 0xD89E,
      0x8AA5, 0x8538, 0x959F, 0x9A02, 0xB4D1, 0xBB4C, 0xABEB, 0xA476,
      0xE307, 0xEC9A, 0xFC3D, 0xF3A0, 0xDD73, 0xD2EE, 0xC249, 0xCDD4,
      0x9FEF, 0x9072, 0x80D5, 0x8F48, 0xA19B, 0xAE06, 0xBEA1, 0xB13C,
      0x154A, 0x1AD7, 0x0A70, 0x05ED, 0x2B3E, 0x24A3, 0x3404, 0x3B99,
      0x69A2, 0x663F, 0x7698, 0x7905, 0x57D6, 0x584B, 0x48EC, 0x4771,
      0xC993, 0xC60E, 0xD6A9, 0xD934, 0xF7E7, 0xF87A, 0xE8DD, 0xE740,
      0xB57B, 0xBAE6, 0xAA41, 0xA5DC, 0x8B0F, 0x8492, 0x9435, 0x9BA8,
      0x3FDE, 0x3043, 0x20E4, 0x2F79, 0x01AA, 0x0E37, 0x1E90, 0x110D,
      0x4336, 0x4CAB, 0x5C0C, 0x5391, 0x7D42, 0x72DF, 0x6278, 0x6DE5,
      0x2A94, 0x2509, 0x35AE, 0x3A33, 0x14E0, 0x1B7D, 0x0BDA, 0x0447,
      0x567C, 0x59E1, 0x4946, 0x46DB, 0x6808, 0x6795, 0x7732, 0x78AF,
      0xDCD9, 0xD344, 0xC3E3, 0xCC7E, 0xE2AD, 0xED30, 0xFD97, 0xF20A,
      0xA031, 0xAFAC, 0xBF0B, 0xB096, 0x9E45, 0x91D8, 0x817F, 0x8EE2,
      0x9CBB, 0x9326, 0x8381, 0x8C1C, 0xA2CF, 0xAD52, 0xBDF5, 0xB268,
      0xE053, 0xEFCE, 0xFF69, 0xF0F4, 0xDE27, 0xD1BA, 0xC11D, 0xCE80,
      0x6AF6, 0x656B, 0x75CC, 0x7A51, 0x5482, 0x5B1F, 0x4BB8, 0x4425,
      0x161E, 0x1983, 0x0924, 0x06B9, 0x286A, 0x27F7, 0x3750, 0x38CD,
      0x7FBC, 0x7021, 0x6086, 0x6F1B, 0x41C8, 0x4E55, 0x5EF2, 0x516F,
      0x0354, 0x0CC9, 0x1C6E, 0x13F3, 0x3D20, 0x32BD, 0x221A, 0x2D87,
      0x89F1, 0x866C, 0x96CB, 0x9956, 0xB785, 0xB818, 0xA8BF, 0xA722,
      0xF519, 0xFA84, 0xEA23, 0xE5BE, 0xCB6D, 0xC4F0, 0xD457, 0xDBCA,
      0x5528, 0x5AB5, 0x4A12, 0x458F, 0x6B5C, 0x64C1, 0x7466, 0x7BFB,
      0x29C0, 0x265D, 0x36FA, 0x3967, 0x17B4, 0x1829, 0x088E, 0x0713,
      0xA365, 0xACF8, 0xBC5F, 0xB3C2, 0x9D11, 0x928C, 0x822B, 0x8DB6,
      0xDF8D, 0xD010, 0xC0B7, 0xCF2A, 0xE1F9, 0xEE64, 0xFEC3, 0xF15E,
      0xB62F, 0xB9B2, 0xA915, 0xA688, 0x885B, 0x87C6, 0x9761, 0x98FC,
      0xCAC7, 0xC55A, 0xD5FD, 0xDA60, 0xF4B3, 0xFB2E, 0xEB89, 0xE414,
      0x4062, 0x4FFF, 0x5F58, 0x50C5, 0x7E16, 0x718B, 0x612C, 0x6EB1,
      0x3C8A, 0x3317, 0x23B0, 0x2C2D, 0x02FE, 0x0D63, 0x1DC4, 0x1259,
    };

    public:
    bool IsCrcOk(const uint8_t message[], uint8_t messageLength);
    uint16_t CalculateCrc(const uint8_t message[], uint8_t length, uint8_t offset = 0);

};
#endif
